<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&display=swap" rel="stylesheet">
  <title>VOCAB FLASHCARDS</title>
  <style>
body {font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;}  
    .wrap { max-width: 720px; margin: 0 auto; padding: 18px; }
    .card {
      background: white; border-radius: 16px; padding: 22px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      min-height: 220px; display: flex; flex-direction: column; justify-content: center;
      user-select: none; cursor: pointer;
    }
.word {
  font-family: "Libre Baskerville", Georgia, serif;
  font-size: 44px;
  line-height: 1.05;
  letter-spacing: -0.01em;
    margin-bottom: 10px; 
}
    .hint { margin-top: 18px; 
             min-height: 1.5em;
color: #666; }
.def {
  font-size: 19px;
  line-height: 1.5;
  margin-top: 18px; 
}    .example { margin-top: 14px; color: #333; font-style: italic; display: none; }
    .row { display: flex; gap: 10px; margin-top: 14px; }
    button {
      flex: 1; padding: 12px 14px; border-radius: 12px; border: 0;
      background: #111; color: white; font-size: 16px;
    }
    button.secondary { background: #e6e6e6; color: #111; }
    .top { display:flex; justify-content: space-between; align-items:center; margin-bottom: 12px; color:#444; }
    .small { font-size: 13px; color:#666; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div><strong>VOCAB FLASHCARDS</strong> <span class="small"></span></div>
      <div class="small" id="counter">0 / 0</div>
    </div>

    <div class="card" id="card" aria-label="Flashcard">
      <div class="word" id="word">Loading…</div>
      <div class="hint" id="hint">Tap to reveal the definition</div>
      <div class="def" id="definition"></div>
      <div class="example" id="example"></div>
    </div>

    <div class="row">
      <button class="secondary" id="shuffleBtn">Shuffle</button>
      <button id="nextBtn">Next</button>
    </div>

 
    </div>

  <script>
    // Your CSV link from Google Sheets
    const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRnVELwrxU0HDlBdXd3V8W7hmXpakmXffJlFqJOCmvFhrrX_7SlCR_ow8QsrUUFT6_Rz_L_1vLYzREq/pub?gid=0&single=true&output=csv";




    let cards = [];
    let index = 0;
    let revealed = false;

    const elWord = document.getElementById("word");
    const elDef = document.getElementById("definition");
    const elEx = document.getElementById("example");
    const elHint = document.getElementById("hint");
    const elCounter = document.getElementById("counter");

    function parseCSV(text) {
      const rows = [];
      let row = [], cell = "", inQuotes = false;
      for (let i = 0; i < text.length; i++) {
        const c = text[i];
        const next = text[i + 1];
        if (c === '"' && next === '"') { cell += '"'; i++; continue; }
        if (c === '"') { inQuotes = !inQuotes; continue; }
        if (c === "," && !inQuotes) { row.push(cell); cell = ""; continue; }
        if ((c === "\n" || c === "\r") && !inQuotes) {
          if (cell.length || row.length) { row.push(cell); rows.push(row); }
          row = []; cell = "";
          continue;
        }
        cell += c;
      }
      if (cell.length || row.length) { row.push(cell); rows.push(row); }
      return rows.filter(r => r.some(x => x && x.trim() !== ""));
    }

    function rowsToCards(rows) {
      if (!rows || !rows.length) return [];

      const headers = (rows[0] || []).map(h => (h || "").toString().trim().toLowerCase());
      let wordI = headers.indexOf("word");
      let defI  = headers.indexOf("definition");
      let exI   = headers.indexOf("example");

   

      // Fallback if headers don't match:
      if (wordI === -1 || defI === -1) {
        wordI = 0; defI = 1; exI = 2;
      }

      return rows.slice(1).map(r => ({
        word: ((r[wordI] ?? "") + "").trim(),
        definition: ((r[defI] ?? "") + "").trim(),
        example: (exI >= 0 ? ((r[exI] ?? "") + "").trim() : "")
      })).filter(c => c.word && c.definition);
    }

    function showCard(i) {
      const c = cards[i];
      revealed = false;
      elWord.textContent = c.word;
      elDef.textContent = c.definition;
      elEx.textContent = c.example ? "Example: " + c.example : "";
      elDef.style.display = "none";
      elEx.style.display = "none";
      elHint.style.display = "block";
      elCounter.textContent = `${i + 1} / ${cards.length}`;
    }

    function toggleReveal() {
      revealed = !revealed;
      elDef.style.display = revealed ? "block" : "none";
      elEx.style.display = (revealed && elEx.textContent) ? "block" : "none";
      elHint.style.display = revealed ? "none" : "block";
    }

    function nextCard() {
      if (!cards.length) return;
      index = (index + 1) % cards.length;
      showCard(index);
    }

    function shuffleCards() {
      for (let i = cards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [cards[i], cards[j]] = [cards[j], cards[i]];
      }
      index = 0;
      showCard(index);
    }

    async function load() {
  try {
    const url = SHEET_CSV_URL + "&_=" + Date.now();
    const res = await fetch(url, { cache: "no-store" });
    if (!res.ok) {
      throw new Error("Fetch failed: " + res.status + " " + res.statusText);
    }

    const text = await res.text();
    const rows = parseCSV(text);
    cards = rowsToCards(rows);

    if (!cards.length) {
      elWord.textContent = "No cards found.";
      elHint.textContent = "Add words to your Google Sheet.";
      return;
    }

    showCard(index);
  } catch (err) {
    elWord.textContent = "Couldn’t load sheet.";
    elHint.textContent = err?.message || String(err);
  }
}

    document.getElementById("card").addEventListener("click", toggleReveal);
    document.getElementById("nextBtn").addEventListener("click", nextCard);
    document.getElementById("shuffleBtn").addEventListener("click", shuffleCards);

    load();
  </script>
</body>
</html>
